# CVE-2008-1447 - DNS Cache Poisoning (Kaminsky)

## Vulnerability
mDNSResponder uses predictable source ports for DNS queries, allowing cache poisoning attacks.

## Fix Required
- Randomize DNS query source ports
- Use ephemeral port range (49152-65535)
- Patch mDNSResponder binary or create wrapper

## Implementation Options

### Option 1: Binary Patch
- Disassemble mDNSResponder
- Find bind() calls
- Replace with random port selection

### Option 2: Interposer Library
```c
// dns_port_randomizer.c
#include <sys/socket.h>
#include <stdlib.h>
#include <time.h>

int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen) {
    // Intercept DNS bind() calls and randomize port
}
```

### Option 3: Kernel Extension
- Create kext that hooks socket operations
- Force random ports for mDNSResponder process

## Files
- patch_mdns.c - Source for DNS fix
- Makefile - Build instructions
- install.sh - Installation script